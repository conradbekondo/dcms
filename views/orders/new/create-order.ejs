<%- include('partials/head.ejs') %>

    <body id="app-container" class="menu-default show-spinner">
        <%- include('../../partials/navbar.ejs') %>
            <%- include('../../partials/menu.ejs')%>

                <form action="" method="post" id="new-order-form">
                    <main>
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-12">
                                    <div class="d-flex mb-4 justify-content-between align-items-center">
                                        <h1>
                                            <%= view.pageTitle %>
                                        </h1>
                                        <div class="btn-group">
                                            <button class="btn btn-success" style="font-size: 20px;" type="submit"><i
                                                    class="fa-solid fa-check"></i> Paid</button>
                                            <button class="btn btn-danger" style="font-size: 20px;" type="reset">
                                                <i class="fa-solid fa-trash"></i> Cancel
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <hr />
                                <div class="row">
                                    <div class="col-8">
                                        <div class="card h-100">
                                            <div class="card-body p-3">
                                                <div class="row">
                                                    <div class="col-7">
                                                        <h4 class="text-muted card-title my-2">Products by Categories
                                                        </h4>
                                                        <ul role="tablist" class="nav nav-pills categories-nav w-100 mb-2">

                                                            <li class="nav-item">
                                                                <a class="nav-link active" data-toggle="pill" role="tab" aria-controls="#all-products" aria-selected="true" href="#all-products">All</a>
                                                            </li>
                                                            <% data.categories.forEach(category=> {%>
                                                                <li class="nav-item">
                                                                    <a class="nav-link" data-toggle="pill" href="#CAT00<%= category.id %>">
                                                                        <%= category.name %>
                                                                    </a>
                                                                </li>
                                                                <%})%>
                                                        </ul>
                                                        <div id="product-tabs" class="tab-content">
                                                            <div class="tab-pane p-3 show fade in active border border-primary" id="all-products" style="max-height: 350px; overflow-y: auto;overflow-x: hidden">
                                                                <% data.products.forEach(product=> {%>
                                                                    <a href="javascript:void(0)" class="overflow-hidden btn btn-outline-primary default mb-1 mr-1 addPct" style="color: black;width: 18.8%!important; border-top-width: 4px;height: 100px" id="ALL_PR00<%= product.id %>" onclick="add_product('<%= product.id %>')">
                                                                        <% if (product.iconUrl) { const
                                                                            icon=product.iconUrl;
                                                                            if(icon.split(':')[0]=='svg' ) { %>
                                                                            <img class="mt-1 mb-1" src="/static/icons/<%= icon.split(':')[1] %>" width="45%">
                                                                            <%} else {%>
                                                                                <i class="<%= icon.split(':')[1] %>" style="font-size: 45px"></i>
                                                                                <%} %>
                                                                                    <%} %>
                                                                                        <p class="card-text mb-2">
                                                                                            <%= product.name %>
                                                                                        </p>
                                                                                        <input name="selectedProduct" type="hidden" value="<%= product.id %>">
                                                                    </a>
                                                                    <%})%>
                                                            </div>
                                                            <% for(let i=0; i < data.categories.length; i++) { %>
                                                                <div style="max-height: 350px; overflow-y: auto;overflow-x: hidden" class="p-3 border border-primary tab-pane fade in" id="CAT00<%= data.categories[i].id%>">
                                                                    <% for(let j=0; j < data.products.length; j++) {
                                                                        if(data.products[j].categoryId
                                                                        !=data.categories[i].id) continue;%>
                                                                        <a href="javascript:void(0)" class="btn btn-outline-primary default mb-1 mr-1 addPct overflow-hidden" style="color: black; width: 18.8%!important; border-top-width: 4px;height: 100px" id="PR00<%= data.products[j].id %>" onclick="add_product('<%= data.products[j].id %>')">
                                                                            <% if(data.products[j].iconUrl) { const
                                                                                icon=data.products[j].iconUrl;
                                                                                if(icon.split(':')[0]=='svg' ) {%>
                                                                                <img class="mt-1 mb-1" src="/static/icons/<%= icon.split(':')[1] %>" width="45%">
                                                                                <%} else {%>
                                                                                    <i class="<%= icon.split(':')[1] %>" style="font-size: 45px"></i>
                                                                                    <%}%>
                                                                                        <%}%>
                                                                                            <p class="card-text mb-2">
                                                                                                <%= data.products[j].name
                                                                                                    %>
                                                                                            </p>
                                                                                            <input name="selectedProduct" type="hidden" value="<%= data.products[j].id %>">
                                                                        </a>
                                                                        <%}%>
                                                                </div>
                                                                <%}%>
                                                        </div>
                                                    </div>
                                                    <div class="col-5">
                                                        <h4 class="text-muted card-title my-2">Services</h4>
                                                        <div class="service-container d-flex flex-wrap gap-3">
                                                            <% for(let service of data.services ) {%>
                                                                <button type="button" class="btn mt-1 ml-1 btn-outline-primary">
                                                                    <input type="hidden" value="<%= service.id %>">
                                                                    <%= service.name %>
                                                                </button>
                                                                <%}%>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="row my-2">
                                                    <div class="col-6">
                                                        <h4 class="text-muted card-title p-0 mt-4 mb-2">Quantity</h4>
                                                        <div class="form-group">
                                                            <input class="form-control" step="1" max="100" type="number" min="1">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-4">
                                        <div class="card">
                                            <div class="card-body">
                                                <h4 class="text-muted card-title">Billing</h4>
                                                <div class="form-group">
                                                    <div class="input-group">
                                                        <input type="text" id="salesearch" class="form-control col-9" placeholder="Find an Order" style="font-size: 15px;">
                                                        <div class="input-group-append">
                                                            <button type="button" class="btn btn-primary  text-center default mr-2 ml-2" onclick="SaleSearch()">
                                                                Search<i class="simple-icon-magnifier"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <span id="errorsale_searsh" class="text-danger"></span>
                                                </div>
                                                <div class="form-group p-0 my-1">
                                                    <select id="customerSelect" name="customerId" class="form-control select2-single " data-width="50%" data-height="20%">
                                                        <option value="">Select a client</option>
                                                        <% for(let client of data.clients) {%>
                                                            <option value="<%= client.id %>">
                                                                <%= `${client.first_name} ${client.last_name || ''
                                                                    }`.trim() %>
                                                            </option>
                                                            <%} %>
                                                    </select>
                                                    <button type="button" class="btn btn-primary  text-center default mr-2 ml-2" data-toggle="modal" data-target="#clientModal">
                                                        Add a new Client <i class="simple-icon-user-follow"></i>
                                                    </button>
                                                </div>

                                                <table class="table table-hover table-striped table-bordered my-2">
                                                    <thead>
                                                        <tr>
                                                            <th>Selected Product</th>
                                                            <th>Quantity</th>
                                                            <th>Service</th>
                                                            <th>Additional Services</th>
                                                            <th></th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>tkldjsf</td>
                                                            <td>5</td>
                                                            <td>kljdslkfj</td>
                                                            <td></td>
                                                            <td></td>
                                                        </tr>
                                                    </tbody>
                                                </table>

                                                <table class="table mt-3 w-100">
                                                    <tr class="d-flex align-items-center">
                                                        <td>Tax (XAF)</td>
                                                        <td class="w-100">
                                                            <input name="tax" class=form-control "></td>
                                                    </tr>

                                                    <tr class=" d-flex align-items-center ">
                                                        <td>Discount (XAF)</td>
                                                        <td class=" w-100 ">
                                                            <input name=" tax " class=form-control ">
                                                        </td>
                                                    </tr>

                                                    <tr class="d-flex align-items-center">
                                                        <td>Total (XAF)</td>
                                                        <td class="w-100"><span class="text-bold" style="font-size:2rem">50</span></td>
                                                    </tr>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                        </div>
                        </div>
                        </div>
                        </div>
                    </main>
                </form>

                <%- include('../../partials/main-footer.ejs') %>
                    <%- include('partials/scripts.ejs') %>
    </body>

    </html>